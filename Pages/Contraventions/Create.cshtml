@page
@model GestCirculation.Pages_Contraventions.CreateModel
@{
    ViewData["Title"] = "Nouvelle Contravention";
}



<!-- Page Content -->

<link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<div class="container my-5 animate__animated animate__fadeInUp">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="form-card shadow-lg p-4 rounded-4 bg-white">
                <h3 class="text-center mb-4 fw-bold text-primary">
                    <i class="fas fa-file-signature me-2"></i>Nouvelle Contravention
                </h3>

                <form id="contraventionForm" method="post">
                    <div asp-validation-summary="ModelOnly" class="text-danger text-center mb-4"></div>

                    <div class="form-group mb-3">
                        <label asp-for="Contravention.Plaque_vehicule" class="control-label fw-semibold">
                            <i class="fas fa-car text-info me-1"></i> Plaque du véhicule
                        </label>
                        <input asp-for="Contravention.Plaque_vehicule" class="form-control shadow-sm" placeholder="Entrez la plaque du véhicule" required />
                        <span asp-validation-for="Contravention.Plaque_vehicule" class="text-danger"></span>
                    </div>

                    <div class="form-group mb-3">
                        <label asp-for="Contravention.Couleur" class="control-label fw-semibold">
                            <i class="fas fa-palette text-warning me-1"></i> Couleur
                        </label>
                        <input asp-for="Contravention.Couleur" class="form-control shadow-sm" placeholder="Entrez la couleur du véhicule" required />
                        <span asp-validation-for="Contravention.Couleur" class="text-danger"></span>
                    </div>

                    <div class="form-group mb-3">
                        <label asp-for="Contravention.Marque" class="control-label fw-semibold">
                            <i class="fas fa-industry text-success me-1"></i> Marque
                        </label>
                        <input asp-for="Contravention.Marque" class="form-control shadow-sm" placeholder="Entrez la marque du véhicule" required />
                        <span asp-validation-for="Contravention.Marque" class="text-danger"></span>
                    </div>

                    <div class="form-group mb-3">
                        <label asp-for="Contravention.Adresse" class="control-label fw-semibold">
                            <i class="fas fa-map-marker-alt text-danger me-1"></i> Adresse
                        </label>
                        <input asp-for="Contravention.Adresse" class="form-control shadow-sm" placeholder="Entrez l'adresse de l'infraction" required />
                        <span asp-validation-for="Contravention.Adresse" class="text-danger"></span>
                    </div>

                    <div class="form-group mb-3">
                        <label asp-for="Contravention.Article_violation" class="control-label fw-semibold">
                            <i class="fas fa-scroll text-secondary me-1"></i> Article violé
                        </label>
                        <input asp-for="Contravention.Article_violation" class="form-control shadow-sm" placeholder="Entrez l'article de violation" required />
                        <span asp-validation-for="Contravention.Article_violation" class="text-danger"></span>
                    </div>

                    <div class="form-group mb-3">
                        <label asp-for="Contravention.Date_contravention" class="control-label fw-semibold">
                            <i class="fas fa-calendar-day text-primary me-1"></i> Date de contravention
                        </label>
                        <input asp-for="Contravention.Date_contravention" type="date" class="form-control shadow-sm" required />
                        <span asp-validation-for="Contravention.Date_contravention" class="text-danger"></span>
                    </div>

                    <div class="form-group mb-3">
                        <label asp-for="Contravention.ConducteurId" class="control-label fw-semibold">
                            <i class="fas fa-user text-primary me-1"></i> Conducteur
                        </label>
                        <select asp-for="Contravention.ConducteurId" class="form-control shadow-sm" asp-items="ViewBag.ConducteurNom" required>
                            <option value="">-- Sélectionnez un conducteur --</option>
                        </select>
                        <span asp-validation-for="Contravention.ConducteurId" class="text-danger"></span>
                    </div>

                    <div class="form-group mb-4">
                        <label asp-for="Contravention.AgentId" class="control-label fw-semibold">
                            <i class="fas fa-user-shield text-success me-1"></i> Agent
                        </label>
                        <select asp-for="Contravention.AgentId" class="form-control shadow-sm" asp-items="ViewBag.AgentNom" required>
                            <option value="">-- Sélectionnez un agent --</option>
                        </select>
                        <span asp-validation-for="Contravention.AgentId" class="text-danger"></span>
                    </div>

                    <div class="text-center">
                        <button type="button" class="btn btn-primary mt-3 px-4 shadow-sm btn-animate" onclick="validateForm()">
                            <i class="fas fa-save me-2"></i> Enregistrer la Contravention
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Bouton Retour -->
    <div class="text-center mt-4">
        <a class="btn btn-outline-secondary shadow-sm px-4" asp-page="Index">
            <i class="fas fa-arrow-left me-2"></i> Retour à la liste
        </a>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}

    <script>
        function validateForm() {
            const form = document.getElementById("contraventionForm");
            let isValid = true;

            form.querySelectorAll("input, select").forEach(input => {
                if (!input.value) {
                    input.classList.add("is-invalid");
                    isValid = false;
                } else {
                    input.classList.remove("is-invalid");
                }
            });

            if (isValid) {
                Swal.fire({
                    title: "Confirmation",
                    text: "Voulez-vous enregistrer cette contravention ?",
                    icon: "question",
                    showCancelButton: true,
                    confirmButtonColor: "#3085d6",
                    cancelButtonColor: "#d33",
                    confirmButtonText: "Oui, enregistrer",
                    cancelButtonText: "Annuler"
                }).then((result) => {
                    if (result.isConfirmed) {
                        form.submit();
                        return RedirectToPage("./Index");
                    }
                });
            } else {
                Swal.fire({
                    icon: "warning",
                    title: "Champs manquants",
                    text: "Veuillez remplir tous les champs obligatoires.",
                    confirmButtonColor: "#3085d6"
                });
            }
        }
    </script>
}

<!-- Inline CSS styles for design and transitions -->
<style>
    /* Main container styling */
    .container {
        margin-top: 50px;
    }

    /* Form card styling */
    .form-card {
        background-color: #f8f9fa;
        border-radius: 12px;
        padding: 2rem;
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .form-card:hover {
        transform: scale(1.02);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.25);
    }

    /* Form fields */
    .form-control {
        border-radius: 50px;
        padding: 0.75rem 1.25rem;
        border: 1px solid #ced4da;
        transition: all 0.3s ease;
        box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .form-control:focus {
        border-color: #6b46c1;
        box-shadow: 0 0 8px rgba(107, 70, 193, 0.4);
        outline: none;
    }

    /* Button styling */
    .btn-primary {
        background: linear-gradient(135deg, #667eea, #764ba2);
        border: none;
        border-radius: 50px;
        padding: 0.75rem 1.5rem;
        transition: background 0.3s ease, transform 0.2s ease;
    }
    .btn-primary:hover {
        background: linear-gradient(135deg, #5a67d8, #6b46c1);
        transform: translateY(-3px);
    }

    /* Error text */
    .text-danger {
        font-size: 0.9rem;
        font-weight: bold;
        color: #e53e3e;
    }

    /* Heading styling */
    h3 {
        font-weight: bold;
        color: #4a5568;
    }

    <style>
    .form-card {
        background: linear-gradient(180deg, #ffffff, #f9f9f9);
        border: 1px solid #e0e0e0;
    }

    .form-control:focus {
        border-color: #007bff;
        box-shadow: 0 0 8px rgba(0, 123, 255, 0.2);
    }

    .btn-animate {
        transition: all 0.2s ease-in-out;
    }

    .btn-animate:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
    }
</style>