@page
@model GestCirculation.Pages_Conducteurs.CreateModel

@{
    ViewData["Title"] = "Nouvelle Contravention";
}
<link rel="stylesheet" href="~/css/styles.css" />


<div class="container my-5">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <div class="form-card shadow-lg p-4 rounded-4 bg-white">
                <h3 class="text-center mb-4">
                    <i class="fas fa-id-card text-primary me-2"></i>Créer un Conducteur
                </h3>

                <form id="conducteurForm" method="post">
                    <div asp-validation-summary="ModelOnly" class="text-danger text-center mb-4"></div>

                    <!-- Nom -->
                    <div class="form-group mb-3">
                        <label asp-for="Conducteur.Nom" class="control-label fw-semibold">
                            <i class="fas fa-user text-info me-1"></i> Nom
                        </label>
                        <input asp-for="Conducteur.Nom" class="form-control shadow-sm" required />
                        <span asp-validation-for="Conducteur.Nom" class="text-danger"></span>
                    </div>

                    <!-- Prénom -->
                    <div class="form-group mb-3">
                        <label asp-for="Conducteur.Prenom" class="control-label fw-semibold">
                            <i class="fas fa-user-tag text-success me-1"></i> Prénom
                        </label>
                        <input asp-for="Conducteur.Prenom" class="form-control shadow-sm" required />
                        <span asp-validation-for="Conducteur.Prenom" class="text-danger"></span>
                    </div>

                    <!-- Sexe -->
                    <div class="form-group mb-3">
                        <label class="control-label fw-semibold">
                            <i class="fas fa-venus-mars text-danger me-1"></i> Sexe
                        </label>
                        <div class="gender-selection d-flex justify-content-around mt-2">
                            <div class="gender-option text-center">
                                <input type="radio" asp-for="Conducteur.Sexe" value="Masculin" id="sexeMasculin" onchange="highlightSelected(this)" required />
                                <label for="sexeMasculin"><i class="fas fa-mars text-primary me-1"></i>Masculin</label>
                            </div>
                            <div class="gender-option text-center">
                                <input type="radio" asp-for="Conducteur.Sexe" value="Féminin" id="sexeFeminin" onchange="highlightSelected(this)" required />
                                <label for="sexeFeminin"><i class="fas fa-venus text-pink me-1"></i>Féminin</label>
                            </div>
                            <div class="gender-option text-center">
                                <input type="radio" asp-for="Conducteur.Sexe" value="Autre" id="sexeAutre" onchange="highlightSelected(this)" required />
                                <label for="sexeAutre"><i class="fas fa-genderless text-secondary me-1"></i>Autre</label>
                            </div>
                        </div>
                        <span asp-validation-for="Conducteur.Sexe" class="text-danger"></span>
                    </div>

                    <!-- NIF -->
                    <div class="form-group mb-4">
                        <label asp-for="Conducteur.Nif" class="control-label fw-semibold">
                            <i class="fas fa-id-badge text-warning me-1"></i> NIF
                        </label>
                        <input asp-for="Conducteur.Nif" class="form-control shadow-sm" required />
                        <span asp-validation-for="Conducteur.Nif" class="text-danger"></span>
                    </div>

                    <!-- Bouton Créer -->
                    <div class="text-center">
                        <button type="button" class="btn btn-primary mt-3 px-4 shadow-sm btn-animate" onclick="validateForm()">
                            <i class="fas fa-save me-2"></i>Créer
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Bouton Retour -->
    <div class="text-center mt-4">
        <a class="btn btn-outline-secondary shadow-sm px-4" asp-page="Index">
            <i class="fas fa-arrow-left me-2"></i> Retour à la liste
        </a>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script>
        function validateForm() {
            const form = document.getElementById("conducteurForm");
            let isValid = true;

            // Validation personnalisée
            form.querySelectorAll("input, select").forEach(input => {
                if (!input.value && !input.checked) { 
                    input.classList.add("is-invalid");
                    isValid = false;
                } else {
                    input.classList.remove("is-invalid");
                }
            });

            if (isValid) {
                Swal.fire({
                    title: "Confirmation",
                    text: "Voulez-vous enregistrer ce Conducteur ?",
                    icon: "question",
                    showCancelButton: true,
                    confirmButtonColor: "#3085d6",
                    cancelButtonColor: "#d33",
                    confirmButtonText: "Oui, enregistrer",
                    cancelButtonText: "Annuler"
                }).then((result) => {
                    if (result.isConfirmed) {
                        form.submit();
                        return RedirectToPage("./Index");
                    }
                });
            } else {
                Swal.fire({
                    icon: "warning",
                    title: "Champs manquants",
                    text: "Veuillez remplir tous les champs obligatoires.",
                    confirmButtonColor: "#3085d6"
                });
            }
        }

        // Sélection animée du genre
        function highlightSelected(radio) {
            const labels = document.querySelectorAll('.gender-option label');
            labels.forEach(label => label.classList.remove('selected'));
            if (radio.checked) {
                const label = document.querySelector(`label[for="${radio.id}"]`);
                label.classList.add('selected');
            }
        }
    </script>

    <style>
        .gender-option label.selected {
            background-color: #007bff;
            color: #fff;
            border-radius: 6px;
            padding: 4px 8px;
            transition: 0.3s;
        }
    </style>
}

<!-- Styles supplémentaires -->
<style>
    body {
        background: linear-gradient(to bottom right, #f8f6ff, #eae4ff);
    }

    .form-card {
        background: linear-gradient(180deg, #ffffff, #f9f9f9);
        border: 1px solid #e0e0e0;
    }

    .form-control:focus {
        border-color: #4f46e5;
        box-shadow: 0 0 8px rgba(79, 70, 229, 0.2);
    }

    .btn-animate {
        transition: all 0.2s ease-in-out;
    }

    .btn-animate:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
    }

    .gender-option input[type="radio"] {
        display: none;
    }

    .gender-option label {
        cursor: pointer;
        padding: 8px 16px;
        border-radius: 20px;
        border: 1px solid transparent;
        transition: all 0.2s;
    }

    .gender-option input[type="radio"]:checked + label {
        background-color: #6b46cf;
        color: white;
        border-color: #4f46e5;
        box-shadow: 0 0 10px rgba(79, 70, 229, 0.2);
    }

    .text-pink {
        color: #e83e8c !important;
    }
</style>
